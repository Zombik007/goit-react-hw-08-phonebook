(this["webpackJsonpgoit-react-hw-08-phonebook"]=this["webpackJsonpgoit-react-hw-08-phonebook"]||[]).push([[4],{26:function(e,t,n){e.exports={link:"Navigation_link__14Pva",activelink:"Navigation_activelink__2kocN"}},27:function(e,t,n){e.exports={link:"AuthNav_link__Tg_qe",activelink:"AuthNav_activelink__2Mji6"}},32:function(e,t,n){e.exports={img:"UserMenu_img__2OE0h",menu:"UserMenu_menu__klfum",text:"UserMenu_text__1CDqy"}},39:function(e,t,n){"use strict";n.d(t,"a",(function(){return m})),n.d(t,"c",(function(){return w})),n.d(t,"d",(function(){return x})),n.d(t,"b",(function(){return S}));var r,c,a=n(10),o=n.n(a),u=n(18),i=n(16),s=n.n(i),l=n(3),b=Object(l.b)("contact/fetchPhoneBookRequest"),j=Object(l.b)("contact/fetchPhoneBookSuccess"),d=Object(l.b)("contact/fetchPhoneBookError"),f=Object(l.b)("contact/addContactsRequest"),h=Object(l.b)("contact/addContactsSuccess"),O=Object(l.b)("contact/addContactsError"),p=Object(l.b)("contact/deleteContactsRequest"),g=Object(l.b)("contact/deleteContactsSuccess "),v=Object(l.b)("contact/deleteContactsError"),x=Object(l.b)("contact/filter"),m={fetchContacts:function(){return function(){var e=Object(u.a)(o.a.mark((function e(t){var n,r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t(b()),e.prev=1,e.next=4,s.a.get("/contacts");case 4:n=e.sent,r=n.data,t(j(r)),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),t(d());case 12:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(t){return e.apply(this,arguments)}}()},addContacts:function(e){return function(){var t=Object(u.a)(o.a.mark((function t(n){var r,c;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n(f),t.prev=1,t.next=4,s.a.post("contacts",e);case 4:r=t.sent,c=r.data,n(h(c)),t.next=12;break;case 9:t.prev=9,t.t0=t.catch(1),n(O());case 12:case"end":return t.stop()}}),t,null,[[1,9]])})));return function(e){return t.apply(this,arguments)}}()},deleteContacts:function(e){return function(){var t=Object(u.a)(o.a.mark((function t(n){return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return p(),t.prev=1,t.next=4,s.a.delete("contacts/".concat(e));case 4:n(g(e)),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(1),n(v(t.t0));case 10:case"end":return t.stop()}}),t,null,[[1,7]])})));return function(e){return t.apply(this,arguments)}}()}},k=n(30),C=function(e){return e.contacts},_=function(e){return e.contacts.filter},y=Object(k.a)([function(e){return C(e).items},_],(function(e,t){var n=t.toLowerCase();return e.filter((function(e){return e.name.toLowerCase().includes(n)}))})),w={getFilter:_,getVisibleContacts:y,getContacts:C},I=n(4),L=n(6),N=n(55),U=n(9),F=Object(l.d)([],(r={},Object(I.a)(r,j,(function(e,t){return t.payload})),Object(I.a)(r,h,(function(e,t){var n=t.payload;return[].concat(Object(N.a)(e),[Object(L.a)({},n)])})),Object(I.a)(r,g,(function(e,t){var n=t.payload;return e.filter((function(e){return e.id!==n}))})),r)),T=Object(l.d)(!1,(c={},Object(I.a)(c,b,(function(){return!0})),Object(I.a)(c,j,(function(){return!1})),Object(I.a)(c,d,(function(){return!1})),Object(I.a)(c,f,(function(){return!0})),Object(I.a)(c,h,(function(){return!1})),Object(I.a)(c,O,(function(){return!1})),Object(I.a)(c,p,(function(){return!0})),Object(I.a)(c,g,(function(){return!1})),Object(I.a)(c,v,(function(){return!1})),c)),z=Object(l.d)(null,{}),B=Object(l.d)("",Object(I.a)({},x,(function(e,t){return t.payload}))),S=Object(U.b)({items:F,isLoading:T,error:z,filter:B})},50:function(e,t,n){e.exports={container:"Container_container__t4o0y"}},52:function(e,t,n){e.exports={heder:"AppBar_heder__2tfuy"}},8:function(e,t,n){"use strict";n.d(t,"b",(function(){return v})),n.d(t,"a",(function(){return g})),n.d(t,"c",(function(){return x}));var r=n(4),c=n(3),a=n(10),o=n.n(a),u=n(18),i=n(16),s=n.n(i),l=n(23);s.a.defaults.baseURL="https://connections-api.herokuapp.com";var b,j=function(e){s.a.defaults.headers.common.Authorization="Bearer ".concat(e)},d=function(){s.a.defaults.headers.common.Authorization=""},f=Object(c.c)("auth/register",function(){var e=Object(u.a)(o.a.mark((function e(t){var n,r,a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,s.a.post("/users/signup",t);case 3:return n=e.sent,r=n.data,j(r.token),e.abrupt("return",r);case 9:return e.prev=9,e.t0=e.catch(0),a=e.t0.data,l.b.error({data:a},{theme:"colored"}),e.abrupt("return",c.c.rejectWithValue());case 14:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(t){return e.apply(this,arguments)}}()),h=Object(c.c)("auth/login",function(){var e=Object(u.a)(o.a.mark((function e(t){var n,r,a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,s.a.post("/users/login",t);case 3:return n=e.sent,r=n.data,j(r.token),e.abrupt("return",r);case 9:return e.prev=9,e.t0=e.catch(0),a=e.t0.data,l.b.error({data:a},{theme:"colored"}),e.abrupt("return",c.c.rejectWithValue());case 14:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(t){return e.apply(this,arguments)}}()),O=Object(c.c)("auth/logout",Object(u.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,s.a.post("/users/logout");case 3:d(),e.next=8;break;case 6:e.prev=6,e.t0=e.catch(0);case 8:case"end":return e.stop()}}),e,null,[[0,6]])})))),p=Object(c.c)("auth/refresh",function(){var e=Object(u.a)(o.a.mark((function e(t,n){var r,c,a,u;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=n.getState(),null!==(c=r.auth.token)){e.next=5;break}return console.log("\u0422\u043e\u043a\u0435\u043d\u0430 \u043d\u0435\u0442, \u0443\u0445\u043e\u0434\u0438\u043c \u0438\u0437 fetchCurrentUser"),e.abrupt("return",n.rejectWithValue());case 5:return j(c),e.prev=6,e.next=9,s.a.get("/users/current");case 9:return a=e.sent,u=a.data,e.abrupt("return",u);case 14:e.prev=14,e.t0=e.catch(6);case 16:case"end":return e.stop()}}),e,null,[[6,14]])})));return function(t,n){return e.apply(this,arguments)}}()),g={register:f,logIn:h,logOut:O,fetchCurrentUser:p},v=Object(c.e)({name:"auth",initialState:{user:{name:null,email:null},token:null,isLoggedIn:!1,isFetchingCurrent:!1},extraReducers:(b={},Object(r.a)(b,g.register.fulfilled,(function(e,t){e.user=t.payload.user,e.token=t.payload.token,e.isLoggedIn=!0})),Object(r.a)(b,g.logIn.fulfilled,(function(e,t){e.user=t.payload.user,e.token=t.payload.token,e.isLoggedIn=!0})),Object(r.a)(b,g.logOut.fulfilled,(function(e,t){e.user={name:null,email:null},e.token=null,e.isLoggedIn=!1})),Object(r.a)(b,g.fetchCurrentUser.pending,(function(e){e.isFetchingCurrent=!0})),Object(r.a)(b,g.fetchCurrentUser.fulfilled,(function(e,t){e.user=t.payload,e.isLoggedIn=!0,e.isFetchingCurrent=!1})),Object(r.a)(b,g.fetchCurrentUser.rejected,(function(e){e.isFetchingCurrent=!1})),b)}).reducer,x={getIsLoggedIn:function(e){return e.auth.isLoggedIn},getUserName:function(e){return e.auth.user.name},getIsFetchingCurrent:function(e){return e.auth.isFetchingCurrent}}},89:function(e,t,n){"use strict";n.r(t);var r=n(0),c=n.n(r),a=n(22),o=n.n(a),u=n(17),i=n(7),s=n(49),l=n(50),b=n.n(l),j=n(1);function d(e){var t=e.children;return Object(j.jsx)("div",{className:b.a.container,children:t})}var f=n(5),h=n(8),O=n(26),p=n.n(O);function g(){var e=Object(i.c)(h.c.getIsLoggedIn);return Object(j.jsxs)("nav",{children:[Object(j.jsx)(u.b,{to:"/",exact:!0,className:p.a.link,activeClassName:p.a.activelink,children:"Home"}),e&&Object(j.jsx)(u.b,{exact:!0,to:"/contacts",className:p.a.link,activeClassName:p.a.activelink,children:"Contacts"})]})}var v=n.p+"static/media/ava.7d81e2a7.svg",x=n(32),m=n.n(x),k=n(91);function C(){var e=Object(i.b)(),t=Object(i.c)(h.c.getUserName);return Object(j.jsxs)("div",{className:m.a.menu,children:[Object(j.jsx)("img",{src:v,alt:"avatar",className:m.a.img}),Object(j.jsxs)("span",{className:m.a.text,children:["Welcome, ",t]}),Object(j.jsx)(k.a,{variant:"primary",type:"button",onClick:function(){return e(h.a.logOut())},children:"LogOut"})]})}var _=n(27),y=n.n(_);function w(){return Object(j.jsxs)("div",{children:[Object(j.jsx)(u.b,{to:"/register",exact:!0,className:y.a.link,activeClassName:y.a.activelink,children:"Registration"}),Object(j.jsx)(u.b,{to:"/login",exact:!0,className:y.a.link,activeClassName:y.a.activelink,children:"LogIn"})]})}var I=n(52),L=n.n(I);function N(){var e=Object(i.c)(h.c.getIsLoggedIn);return console.log("isLoggedIn",e),Object(j.jsxs)("header",{className:L.a.heder,children:[Object(j.jsx)(g,{}),e?Object(j.jsx)(C,{}):Object(j.jsx)(w,{})]})}var U=n(6),F=n(20),T=["redirectTo","children"];function z(e){var t=e.redirectTo,n=void 0===t?"/":t,r=e.children,c=Object(F.a)(e,T),a=Object(i.c)(h.c.getIsLoggedIn);return Object(j.jsx)(f.b,Object(U.a)(Object(U.a)({},c),{},{children:a?r:Object(j.jsx)(f.a,{to:n})}))}var B=["children","restricted","redirectTo"];function S(e){var t=e.children,n=e.restricted,r=void 0!==n&&n,c=e.redirectTo,a=void 0===c?"/":c,o=Object(F.a)(e,B),u=Object(i.c)(h.c.getIsLoggedIn)&&r;return Object(j.jsx)(f.b,Object(U.a)(Object(U.a)({},o),{},{children:u?Object(j.jsx)(f.a,{to:a}):t}))}n(85);var A=n(23),E=(n(86),Object(r.lazy)((function(){return n.e(3).then(n.bind(null,102))}))),P=Object(r.lazy)((function(){return n.e(1).then(n.bind(null,103))})),R=Object(r.lazy)((function(){return n.e(2).then(n.bind(null,104))})),q=Object(r.lazy)((function(){return Promise.all([n.e(7),n.e(0)]).then(n.bind(null,106))}));function M(){var e=Object(i.b)(),t=Object(i.c)(h.c.getIsFetchingCurrent);return Object(r.useEffect)((function(){e(h.a.fetchCurrentUser())}),[e]),!t&&Object(j.jsxs)(d,{children:[Object(j.jsx)(N,{}),Object(j.jsx)(f.d,{children:Object(j.jsxs)(r.Suspense,{fallback:Object(j.jsx)("p",{children:"Loading..."}),children:[Object(j.jsx)(S,{exact:!0,path:"/",children:Object(j.jsx)(P,{})}),Object(j.jsx)(S,{exact:!0,path:"/register",restricted:!0,children:Object(j.jsx)(E,{})}),Object(j.jsx)(S,{exact:!0,path:"/login",restricted:!0,redirectTo:"/contacts",children:Object(j.jsx)(R,{})}),Object(j.jsx)(z,{path:"/contacts",redirectTo:"/login",children:Object(j.jsx)(q,{})})]})}),Object(j.jsx)(A.a,{position:"top-center",autoClose:3e3,hideProgressBar:!1,newestOnTop:!1,closeOnClick:!0,rtl:!1,pauseOnFocusLoss:!0,draggable:!0,pauseOnHover:!0})]})}var V=n(3),W=n(19),H=n(53),J=n.n(H),D=n(54),G=n.n(D),K=n(39),Q={key:"auth",storage:G.a,whitelist:["token"]},X=Object(V.a)({reducer:{auth:Object(W.g)(Q,h.b),contacts:K.b},middleware:function(e){return e({serializableCheck:{ignoredActions:[W.a,W.f,W.b,W.c,W.d,W.e]},logger:J.a})},devTools:!1}),Y=Object(W.h)(X);o.a.render(Object(j.jsx)(c.a.StrictMode,{children:Object(j.jsx)(i.a,{store:X,children:Object(j.jsx)(s.a,{loading:null,persistor:Y,children:Object(j.jsx)(u.a,{children:Object(j.jsx)(M,{})})})})}),document.getElementById("root"))}},[[89,5,6]]]);
//# sourceMappingURL=main.517dd8f3.chunk.js.map
(this["webpackJsonpgoit-react-hw-08-phonebook"]=this["webpackJsonpgoit-react-hw-08-phonebook"]||[]).push([[4],{26:function(t,e,n){t.exports={link:"Navigation_link__14Pva",activelink:"Navigation_activelink__2kocN"}},27:function(t,e,n){t.exports={img:"UserMenu_img__2OE0h",menu:"UserMenu_menu__klfum",text:"UserMenu_text__1CDqy",text_name:"UserMenu_text_name__223PS"}},36:function(t,e,n){t.exports={link:"AuthNav_link__Tg_qe",activelink:"AuthNav_activelink__2Mji6"}},39:function(t,e,n){"use strict";n.d(e,"a",(function(){return m})),n.d(e,"c",(function(){return w})),n.d(e,"d",(function(){return x})),n.d(e,"b",(function(){return M}));var r,c,a=n(10),u=n.n(a),o=n(18),s=n(16),i=n.n(s),l=n(3),b=Object(l.b)("contact/fetchContactsRequest"),j=Object(l.b)("contact/fetchContactsSuccess"),d=Object(l.b)("contact/fetchContactsError"),f=Object(l.b)("contact/addContactsRequest"),O=Object(l.b)("contact/addContactsSuccess"),h=Object(l.b)("contact/addContactsError"),p=Object(l.b)("contact/deleteContactsRequest"),g=Object(l.b)("contact/deleteContactsSuccess "),v=Object(l.b)("contact/deleteContactsError"),x=Object(l.b)("contact/filter"),m={fetchContacts:function(){return function(){var t=Object(o.a)(u.a.mark((function t(e){var n,r;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e(b()),t.prev=1,t.next=4,i.a.get("/contacts");case 4:n=t.sent,r=n.data,e(j(r)),t.next=12;break;case 9:t.prev=9,t.t0=t.catch(1),e(d());case 12:case"end":return t.stop()}}),t,null,[[1,9]])})));return function(e){return t.apply(this,arguments)}}()},addContacts:function(t){return function(){var e=Object(o.a)(u.a.mark((function e(n){var r,c;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n(f),e.prev=1,e.next=4,i.a.post("contacts",t);case 4:r=e.sent,c=r.data,n(O(c)),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),n(h());case 12:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(t){return e.apply(this,arguments)}}()},deleteContacts:function(t){return function(){var e=Object(o.a)(u.a.mark((function e(n){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return p(),e.prev=1,e.next=4,i.a.delete("contacts/".concat(t));case 4:n(g(t)),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(1),n(v(e.t0));case 10:case"end":return e.stop()}}),e,null,[[1,7]])})));return function(t){return e.apply(this,arguments)}}()}},k=n(30),C=function(t){return t.contacts},_=function(t){return t.contacts.filter},y=Object(k.a)([function(t){return C(t).items},_],(function(t,e){var n=e.toLowerCase();return t.filter((function(t){return t.name.toLowerCase().includes(n)}))})),w={getFilter:_,getVisibleContacts:y,getContacts:C},I=n(4),L=n(6),N=n(55),U=n(9),F=Object(l.d)([],(r={},Object(I.a)(r,j,(function(t,e){return e.payload})),Object(I.a)(r,O,(function(t,e){var n=e.payload;return[].concat(Object(N.a)(t),[Object(L.a)({},n)])})),Object(I.a)(r,g,(function(t,e){var n=e.payload;return t.filter((function(t){return t.id!==n}))})),r)),z=Object(l.d)(!1,(c={},Object(I.a)(c,b,(function(){return!0})),Object(I.a)(c,j,(function(){return!1})),Object(I.a)(c,d,(function(){return!1})),Object(I.a)(c,f,(function(){return!0})),Object(I.a)(c,O,(function(){return!1})),Object(I.a)(c,h,(function(){return!1})),Object(I.a)(c,p,(function(){return!0})),Object(I.a)(c,g,(function(){return!1})),Object(I.a)(c,v,(function(){return!1})),c)),T=Object(l.d)(null,{}),S=Object(l.d)("",Object(I.a)({},x,(function(t,e){return e.payload}))),M=Object(U.b)({items:F,isLoading:z,error:T,filter:S})},50:function(t,e,n){t.exports={container:"Container_container__t4o0y"}},52:function(t,e,n){t.exports={header:"AppBar_header__1MyFm"}},8:function(t,e,n){"use strict";n.d(e,"b",(function(){return v})),n.d(e,"a",(function(){return g})),n.d(e,"c",(function(){return x}));var r=n(4),c=n(3),a=n(10),u=n.n(a),o=n(18),s=n(16),i=n.n(s),l=n(23);i.a.defaults.baseURL="https://connections-api.herokuapp.com";var b,j=function(t){i.a.defaults.headers.common.Authorization="Bearer ".concat(t)},d=function(){i.a.defaults.headers.common.Authorization=""},f=Object(c.c)("auth/register",function(){var t=Object(o.a)(u.a.mark((function t(e){var n,r,a;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,i.a.post("/users/signup",e);case 3:return n=t.sent,r=n.data,j(r.token),t.abrupt("return",r);case 9:return t.prev=9,t.t0=t.catch(0),a=t.t0.data,l.b.error({data:a},{theme:"colored"}),t.abrupt("return",c.c.rejectWithValue());case 14:case"end":return t.stop()}}),t,null,[[0,9]])})));return function(e){return t.apply(this,arguments)}}()),O=Object(c.c)("auth/login",function(){var t=Object(o.a)(u.a.mark((function t(e){var n,r,a;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,i.a.post("/users/login",e);case 3:return n=t.sent,r=n.data,j(r.token),t.abrupt("return",r);case 9:return t.prev=9,t.t0=t.catch(0),a=t.t0.data,l.b.error({data:a},{theme:"colored"}),t.abrupt("return",c.c.rejectWithValue());case 14:case"end":return t.stop()}}),t,null,[[0,9]])})));return function(e){return t.apply(this,arguments)}}()),h=Object(c.c)("auth/logout",Object(o.a)(u.a.mark((function t(){return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,i.a.post("/users/logout");case 3:d(),t.next=8;break;case 6:t.prev=6,t.t0=t.catch(0);case 8:case"end":return t.stop()}}),t,null,[[0,6]])})))),p=Object(c.c)("auth/refresh",function(){var t=Object(o.a)(u.a.mark((function t(e,n){var r,c,a,o;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=n.getState(),null!==(c=r.auth.token)){t.next=5;break}return console.log("\u0422\u043e\u043a\u0435\u043d\u0430 \u043d\u0435\u0442, \u0443\u0445\u043e\u0434\u0438\u043c \u0438\u0437 fetchCurrentUser"),t.abrupt("return",n.rejectWithValue());case 5:return j(c),t.prev=6,t.next=9,i.a.get("/users/current");case 9:return a=t.sent,o=a.data,t.abrupt("return",o);case 14:t.prev=14,t.t0=t.catch(6);case 16:case"end":return t.stop()}}),t,null,[[6,14]])})));return function(e,n){return t.apply(this,arguments)}}()),g={register:f,logIn:O,logOut:h,fetchCurrentUser:p},v=Object(c.e)({name:"auth",initialState:{user:{name:null,email:null},token:null,isLoggedIn:!1,isFetchingCurrent:!1},extraReducers:(b={},Object(r.a)(b,g.register.fulfilled,(function(t,e){t.user=e.payload.user,t.token=e.payload.token,t.isLoggedIn=!0})),Object(r.a)(b,g.logIn.fulfilled,(function(t,e){t.user=e.payload.user,t.token=e.payload.token,t.isLoggedIn=!0})),Object(r.a)(b,g.logOut.fulfilled,(function(t,e){t.user={name:null,email:null},t.token=null,t.isLoggedIn=!1})),Object(r.a)(b,g.fetchCurrentUser.pending,(function(t){t.isFetchingCurrent=!0})),Object(r.a)(b,g.fetchCurrentUser.fulfilled,(function(t,e){t.user=e.payload,t.isLoggedIn=!0,t.isFetchingCurrent=!1})),Object(r.a)(b,g.fetchCurrentUser.rejected,(function(t){t.isFetchingCurrent=!1})),b)}).reducer,x={getIsLoggedIn:function(t){return t.auth.isLoggedIn},getUserName:function(t){return t.auth.user.name},getIsFetchingCurrent:function(t){return t.auth.isFetchingCurrent}}},90:function(t,e,n){"use strict";n.r(e);var r=n(0),c=n.n(r),a=n(22),u=n.n(a),o=n(17),s=n(7),i=n(49),l=n(50),b=n.n(l),j=n(1);function d(t){var e=t.children;return Object(j.jsx)("div",{className:b.a.container,children:e})}var f=n(5),O=n(8),h=n(26),p=n.n(h);function g(){var t=Object(s.c)(O.c.getIsLoggedIn);return Object(j.jsxs)("nav",{children:[Object(j.jsx)(o.b,{to:"/",exact:!0,className:p.a.link,activeClassName:p.a.activelink,children:"Home"}),t&&Object(j.jsx)(o.b,{exact:!0,to:"/contacts",className:p.a.link,activeClassName:p.a.activelink,children:"Contacts"})]})}var v=n(91),x=n.p+"static/media/avatar.5bb45d4f.svg",m=n(27),k=n.n(m);function C(){var t=Object(s.b)(),e=Object(s.c)(O.c.getUserName);return Object(j.jsxs)("div",{className:k.a.menu,children:[Object(j.jsx)("img",{src:x,alt:"avatar",className:k.a.img}),Object(j.jsxs)("span",{className:k.a.text,children:["Welcome, ",Object(j.jsx)("span",{className:k.a.text_name,children:e})]}),Object(j.jsx)(v.a,{variant:"outline-primary",type:"button",size:"sm",onClick:function(){return t(O.a.logOut())},children:"LogOut"})]})}var _=n(36),y=n.n(_);function w(){return Object(j.jsxs)("div",{children:[Object(j.jsx)(o.b,{to:"/register",exact:!0,className:y.a.link,activeClassName:y.a.activelink,children:"Registration"}),Object(j.jsx)(o.b,{to:"/login",exact:!0,children:Object(j.jsx)(v.a,{variant:"outline-primary",type:"button",size:"sm",children:"LogIn"})})]})}var I=n(52),L=n.n(I);function N(){var t=Object(s.c)(O.c.getIsLoggedIn);return console.log("isLoggedIn",t),Object(j.jsxs)("header",{className:L.a.header,children:[Object(j.jsx)(g,{}),t?Object(j.jsx)(C,{}):Object(j.jsx)(w,{})]})}var U=n(6),F=n(20),z=["redirectTo","children"];function T(t){var e=t.redirectTo,n=void 0===e?"/":e,r=t.children,c=Object(F.a)(t,z),a=Object(s.c)(O.c.getIsLoggedIn);return Object(j.jsx)(f.b,Object(U.a)(Object(U.a)({},c),{},{children:a?r:Object(j.jsx)(f.a,{to:n})}))}var S=["children","restricted","redirectTo"];function M(t){var e=t.children,n=t.restricted,r=void 0!==n&&n,c=t.redirectTo,a=void 0===c?"/":c,u=Object(F.a)(t,S),o=Object(s.c)(O.c.getIsLoggedIn)&&r;return Object(j.jsx)(f.b,Object(U.a)(Object(U.a)({},u),{},{children:o?Object(j.jsx)(f.a,{to:a}):e}))}n(86);var A=n(23),E=(n(87),Object(r.lazy)((function(){return n.e(3).then(n.bind(null,102))}))),R=Object(r.lazy)((function(){return n.e(1).then(n.bind(null,103))})),q=Object(r.lazy)((function(){return n.e(2).then(n.bind(null,104))})),B=Object(r.lazy)((function(){return Promise.all([n.e(7),n.e(0)]).then(n.bind(null,106))}));function P(){var t=Object(s.b)(),e=Object(s.c)(O.c.getIsFetchingCurrent);return Object(r.useEffect)((function(){t(O.a.fetchCurrentUser())}),[t]),!e&&Object(j.jsxs)(d,{children:[Object(j.jsx)(N,{}),Object(j.jsx)(f.d,{children:Object(j.jsxs)(r.Suspense,{fallback:Object(j.jsx)("p",{children:"Loading..."}),children:[Object(j.jsx)(M,{exact:!0,path:"/",children:Object(j.jsx)(R,{})}),Object(j.jsx)(M,{exact:!0,path:"/register",restricted:!0,children:Object(j.jsx)(E,{})}),Object(j.jsx)(M,{exact:!0,path:"/login",restricted:!0,redirectTo:"/contacts",children:Object(j.jsx)(q,{})}),Object(j.jsx)(T,{path:"/contacts",redirectTo:"/login",children:Object(j.jsx)(B,{})})]})}),Object(j.jsx)(A.a,{position:"top-center",autoClose:3e3,hideProgressBar:!1,newestOnTop:!1,closeOnClick:!0,rtl:!1,pauseOnFocusLoss:!0,draggable:!0,pauseOnHover:!0})]})}var V=n(3),W=n(19),H=n(53),J=n.n(H),D=n(54),G=n.n(D),K=n(39),Q={key:"auth",storage:G.a,whitelist:["token"]},X=Object(V.a)({reducer:{auth:Object(W.g)(Q,O.b),contacts:K.b},middleware:function(t){return t({serializableCheck:{ignoredActions:[W.a,W.f,W.b,W.c,W.d,W.e]},logger:J.a})},devTools:!1}),Y=Object(W.h)(X);u.a.render(Object(j.jsx)(c.a.StrictMode,{children:Object(j.jsx)(s.a,{store:X,children:Object(j.jsx)(i.a,{loading:null,persistor:Y,children:Object(j.jsx)(o.a,{children:Object(j.jsx)(P,{})})})})}),document.getElementById("root"))}},[[90,5,6]]]);
//# sourceMappingURL=main.1951c782.chunk.js.map